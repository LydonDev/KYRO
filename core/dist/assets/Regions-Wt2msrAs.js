import{r as o,c as fe,u as ve,j as e,L as je,o as J,B as f,m as L,n as pe}from"./main-D6weWVn6.js";import{C as se}from"./card-DxFMsxNs.js";import{F as te,a as ne}from"./PlusIcon-CtXArJJt.js";import{F as ae}from"./TrashIcon-CRYsBrOY.js";import{F as Ne}from"./ArrowLeftIcon-CzYvxG5u.js";import{F as be}from"./EllipsisVerticalIcon-Yt-jlAPq.js";function ye({title:c,titleId:v,...u},R){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:R,"aria-labelledby":v},u),c?o.createElement("title",{id:v},c):null,o.createElement("path",{d:"M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"}))}const we=o.forwardRef(ye),re=({type:c,message:v,onDismiss:u})=>{const R=c==="error"?"bg-red-50":c==="success"?"bg-green-50":"bg-yellow-50",g=c==="error"?"text-red-600":c==="success"?"text-green-600":"text-yellow-600",b=c==="error"?"border-red-100":c==="success"?"border-green-100":"border-yellow-100";return e.jsxs("div",{className:`${R} border ${b} rounded-md flex items-start justify-between`,children:[e.jsxs("div",{className:"flex items-start p-2",children:[c==="error"||c==="warning"?e.jsx(pe,{className:`w-3 h-3 ${g} mr-2 mt-0.5`}):null,e.jsx("p",{className:`text-xs ${g}`,children:v})]}),u&&e.jsx("button",{onClick:u,className:`ml-2 mr-2 p-1 ${g} hover:bg-opacity-10 cursor-pointer rounded-full`,children:"Ã—"})]})},q=[{value:"",label:"None"},{value:"AF",label:"Afghanistan"},{value:"AU",label:"Australia"},{value:"BR",label:"Brazil"},{value:"CA",label:"Canada"},{value:"CN",label:"China"},{value:"DE",label:"Germany"},{value:"FR",label:"France"},{value:"GB",label:"United Kingdom"},{value:"IN",label:"India"},{value:"JP",label:"Japan"},{value:"NL",label:"Netherlands"},{value:"NO",label:"Norway"},{value:"RU",label:"Russia"},{value:"SE",label:"Sweden"},{value:"SG",label:"Singapore"},{value:"US",label:"United States"}],ke=({position:c,onClose:v,onEdit:u,onDelete:R})=>{const g=o.useRef(null),[b,P]=o.useState(c);o.useEffect(()=>{const y=x=>{g.current&&x.target instanceof Node&&!g.current.contains(x.target)&&v()},j=()=>{if(g.current){const x=g.current.getBoundingClientRect(),k={width:window.innerWidth,height:window.innerHeight};let w=c.x,n=c.y;w+x.width>k.width&&(w=Math.max(0,k.width-x.width-16)),n+x.height>k.height&&(n=Math.max(0,k.height-x.height-16)),P({x:w,y:n})}};document.addEventListener("mousedown",y);const I=setTimeout(j,10);return()=>{document.removeEventListener("mousedown",y),clearTimeout(I)}},[v,c]);const E=[{label:"Edit",icon:ne,action:u},{label:"Delete",icon:ae,action:R,destructive:!0}];return e.jsx(L.div,{ref:g,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.1},className:"fixed z-50 w-36 bg-stone-950 border border-stone-900 rounded-lg py-1",style:{top:b.y,left:b.x},children:E.map(({label:y,icon:j,action:I,destructive:x})=>e.jsxs("button",{onClick:k=>{k.stopPropagation(),I()},className:`w-full px-3 py-2 text-left flex items-center space-x-2 text-sm ${x?"text-red-500 hover:bg-red-900/20":"text-stone-400 hover:bg-stone-900/20"}`,children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:y})]},y))})},Ie=()=>{const[c,v]=o.useState([]),[u,R]=o.useState([]),[g,b]=o.useState(!0),[P,E]=o.useState(null),[y,j]=o.useState("list"),[I,x]=o.useState(!1),[k,w]=o.useState(!1),[n,C]=o.useState(null),[F,z]=o.useState("overview"),[m,p]=o.useState({name:"",identifier:""}),[G,M]=o.useState(null),[H,O]=o.useState([]),[V,ie]=o.useState("name"),[oe,K]=o.useState("asc"),[W,X]=o.useState(!1),[N,D]=o.useState(null),[T,Y]=o.useState(""),{user:B}=fe(),Q=ve();o.useEffect(()=>{(!B||!B.permissions.includes("admin"))&&Q("/unauthorized",{replace:!0})},[B,Q]),console.log(P),o.useEffect(()=>{A()},[]);const h=o.useCallback((t,s)=>{const r=Date.now().toString();return O(a=>[...a,{id:r,type:t,message:s}]),setTimeout(()=>{O(a=>a.filter(l=>l.id!==r))},5e3),r},[]),le=o.useCallback(t=>{O(s=>s.filter(r=>r.id!==t))},[]),A=async()=>{try{b(!0);const s={Authorization:`Bearer ${localStorage.getItem("token")}`},[r,a]=await Promise.all([fetch("/api/regions",{headers:s}),fetch("/api/nodes",{headers:s})]);if(!r.ok){const d=await r.json();throw new Error(d.error||"Failed to fetch regions")}if(!a.ok){const d=await a.json();throw new Error(d.error||"Failed to fetch nodes")}const[l,i]=await Promise.all([r.json(),a.json()]),S=i.filter(d=>!d.regionId);if(R(S),v(l),n&&y==="view"){const d=l.find(Z=>Z.id===n.id);d&&C(d)}E(null)}catch(t){const s=t instanceof Error?t.message:"An error occurred";E(s),h("error",s)}finally{b(!1)}},U=async t=>{try{b(!0);const s=localStorage.getItem("token"),r=await fetch(`/api/regions/${t}`,{headers:{Authorization:`Bearer ${s}`}});if(!r.ok){const l=await r.json();throw new Error(l.error||"Failed to fetch region")}const a=await r.json();return v(l=>l.map(i=>i.id===t?a:i)),n&&n.id===t&&C(a),E(null),a}catch(s){const r=s instanceof Error?s.message:"An error occurred";return h("error",r),null}finally{b(!1)}},ce=async t=>{t.preventDefault(),M(null);try{const s=localStorage.getItem("token"),r=await fetch("/api/regions",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(m)}),a=await r.json();if(!r.ok){const l=Array.isArray(a.error)?a.error.map(i=>i.message).join(", "):a.error||"Failed to create region";throw new Error(l)}await A(),x(!1),j("list"),p({name:"",identifier:""}),h("success",`Region "${m.name}" created successfully`)}catch(s){const r=s instanceof Error?s.message:"Failed to create region";M(r),h("error",r)}},de=async t=>{if(t.preventDefault(),!!n){M(null);try{const s=localStorage.getItem("token"),r=await fetch(`/api/regions/${n.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(m)}),a=await r.json();if(!r.ok){const i=Array.isArray(a.error)?a.error.map(S=>S.message).join(", "):a.error||"Failed to update region";throw new Error(i)}await A(),h("success",`Region "${m.name}" updated successfully`);const l=await U(n.id);l&&C(l),w(!1),j("view"),p({name:"",identifier:""})}catch(s){const r=s instanceof Error?s.message:"Failed to update region";M(r),h("error",r)}}},_=async t=>{try{const s=localStorage.getItem("token"),r=await fetch(`/api/regions/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!r.ok){const a=await r.json();throw new Error(a.error||"Failed to delete region")}await A(),(n==null?void 0:n.id)===t&&(j("list"),C(null)),h("success","Region deleted successfully")}catch(s){const r=s instanceof Error?s.message:"Failed to delete region";h("error",r)}},xe=async()=>{if(!(!n||!T))try{X(!0);const t=localStorage.getItem("token"),s=await fetch(`/api/nodes/${T}/region`,{method:"PATCH",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({regionId:n.id})});if(!s.ok){const a=await s.json();throw new Error(a.error||"Failed to assign node to region")}await A();const r=await U(n.id);r&&C(r),Y(""),h("success","Node assigned to region successfully")}catch(t){const s=t instanceof Error?t.message:"Failed to assign node";h("error",s)}finally{X(!1)}},me=async t=>{try{const s=localStorage.getItem("token"),r=await fetch(`/api/nodes/${t}/region`,{method:"PATCH",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({regionId:null})});if(!r.ok){const a=await r.json();throw new Error(a.error||"Failed to unassign node from region")}if(await A(),n){const a=await U(n.id);a&&C(a)}h("success","Node unassigned from region successfully")}catch(s){const r=s instanceof Error?s.message:"Failed to unassign node";h("error",r)}},$=t=>{V===t?K(s=>s==="asc"?"desc":"asc"):(ie(t),K("asc"))},he=()=>[...c].sort((t,s)=>{var a,l;let r=0;switch(V){case"name":r=t.name.localeCompare(s.name);break;case"identifier":r=t.identifier.localeCompare(s.identifier);break;case"country":const i=t.countryId||"",S=s.countryId||"";r=i.localeCompare(S);break;case"nodes":r=t.nodes.length-s.nodes.length;break;case"servers":const d=((a=t.stats)==null?void 0:a.serverCount)||0,Z=((l=s.stats)==null?void 0:l.serverCount)||0;r=d-Z;break;default:r=0}return oe==="asc"?r:-r}),ee=t=>e.jsxs("form",{onSubmit:t==="create"?ce:de,className:"space-y-4 max-w-lg",children:[G&&e.jsx(re,{type:"error",message:G,onDismiss:()=>M(null)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Name"}),e.jsx("input",{type:"text",value:m.name,onChange:s=>p({...m,name:s.target.value}),className:`mt-1 w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                    text-sm text-white
                    focus:outline-none focus:ring-1 focus:ring-stone-900 focus:border-stone-900
                    transition-colors duration-200`,placeholder:"Europe North",required:!0,maxLength:100}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"A descriptive name for this region"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Identifier"}),e.jsx("input",{type:"text",value:m.identifier,onChange:s=>p({...m,identifier:s.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")}),className:`mt-1 w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                    text-sm text-white
                    focus:outline-none focus:ring-1 focus:ring-stone-900 focus:border-stone-900
                    transition-colors duration-200`,placeholder:"eu-north",required:!0,pattern:"^[a-z0-9-]+$",maxLength:20}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"A unique lowercase identifier (a-z, 0-9, hyphens only)"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Country (Optional)"}),e.jsx("select",{value:m.countryId||"",onChange:s=>p({...m,countryId:s.target.value||void 0}),className:`mt-1 w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                    text-sm text-white
                    focus:outline-none focus:ring-1 focus:ring-stone-900 focus:border-stone-900
                    transition-colors duration-200`,children:q.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"The country where this region is located"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Fallback Region (Optional)"}),e.jsxs("select",{value:m.fallbackRegionId||"",onChange:s=>p({...m,fallbackRegionId:s.target.value||void 0}),className:`mt-1 w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                    text-sm text-white
                    focus:outline-none focus:ring-1 focus:ring-stone-900 focus:border-stone-900
                    transition-colors duration-200`,children:[e.jsx("option",{value:"",children:"None"}),c.filter(s=>t==="create"||s.id!==(n==null?void 0:n.id)).map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Region to use if no nodes are available in this region"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Server Limit (Optional)"}),e.jsx("input",{type:"number",value:m.serverLimit||"",onChange:s=>p({...m,serverLimit:s.target.value?parseInt(s.target.value):void 0}),className:`mt-1 w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                    text-sm text-white
                    focus:outline-none focus:ring-1 focus:ring-stone-900 focus:border-stone-900
                    transition-colors duration-200`,min:0,placeholder:"No limit"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum number of servers allowed in this region"})]}),e.jsxs("div",{className:"flex items-center space-x-3 justify-end",children:[e.jsx(f,{type:"button",onClick:()=>{x(!1),w(!1)},children:"Cancel"}),e.jsx(f,{type:"submit",variant:"secondary",icon:e.jsx(te,{className:"w-3.5 h-3.5 mr-1.5"}),children:t==="create"?"Create Region":"Update Region"})]})]}),ue=()=>{var s,r,a,l;if(!n)return null;const t=((s=n.stats)==null?void 0:s.serverCount)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(f,{onClick:()=>{j("list")},variant:"secondary",icon:e.jsx(Ne,{className:"w-3 h-3"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:n.name}),e.jsx("p",{className:"text-xs text-white",children:n.identifier})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(f,{onClick:()=>{w(!0),p({name:n.name,identifier:n.identifier,countryId:n.countryId||void 0,fallbackRegionId:n.fallbackRegionId||void 0,serverLimit:n.serverLimit||void 0})},variant:"secondary",icon:e.jsx(ne,{className:"w-4 h-4"}),children:"Edit"}),e.jsx(f,{onClick:()=>_(n.id),variant:"danger",icon:e.jsx(ae,{className:"w-4 h-4"}),children:"Delete"})]})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(f,{onClick:()=>z("overview"),variant:F==="overview"?"primary":"secondary",className:F==="overview"?"font-bold":"font-normal",children:"Overview"}),e.jsxs(f,{onClick:()=>z("nodes"),variant:F==="nodes"?"primary":"secondary",className:F==="nodes"?"font-bold":"font-normal",children:["Nodes (",n.nodes.length,")"]}),e.jsxs(f,{onClick:()=>z("servers"),variant:F==="servers"?"primary":"secondary",className:F==="servers"?"font-bold":"font-normal",children:["Servers (",t,")"]})]}),F==="overview"?e.jsx(se,{className:"bg-stone-950 border border-stone-900",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Region ID"}),e.jsx("div",{className:"text-sm font-mono mt-1 text-gray-500",children:n.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Name"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:n.name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Identifier"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:n.identifier})]}),n.countryId&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Country"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:((r=q.find(i=>i.value===n.countryId))==null?void 0:r.label)||n.countryId})]}),n.fallbackRegionId&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Fallback Region"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:((a=n.fallbackRegion)==null?void 0:a.name)||"Loading..."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Server Limit"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:n.serverLimit?n.serverLimit:"No limit"})]}),e.jsxs("div",{className:"pt-4 border-t border-stone-900",children:[e.jsx("div",{className:"text-xs font-medium text-white mb-3",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Nodes"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:n.nodes.length})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Online Nodes"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:((l=n.stats)==null?void 0:l.onlineNodeCount)||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Servers"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:t})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-stone-900",children:[e.jsx("div",{className:"text-xs text-white",children:"Created At"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:new Date(n.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white",children:"Updated At"}),e.jsx("div",{className:"text-sm mt-1 text-gray-500",children:new Date(n.updatedAt).toLocaleString()})]})]})})}):F==="nodes"?e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("div",{className:"bg-stone-950 border border-stone-900 rounded-md shadow-xs",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-sm font-medium text-white",children:"Nodes in Region"})}),e.jsx("div",{className:"space-y-2",children:n.nodes.length>0?n.nodes.map(i=>e.jsxs(se,{className:"flex items-center justify-between p-3 bg-stone-950 rounded-md border border-stone-900",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${i.isOnline?"bg-green-400":"bg-gray-300"}`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-white",children:i.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[i.fqdn,":",i.port]})]})]}),e.jsx(f,{onClick:()=>me(i.id),variant:"secondary",children:"Unassign"})]},i.id)):e.jsx("div",{className:"py-6 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No nodes in this region"})})})]})})}),e.jsx("div",{children:e.jsx("div",{className:"bg-stone-950 border border-stone-900 rounded-md shadow-xs",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"Assign Node to Region"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Add an existing node to this region."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Node"}),e.jsxs("select",{value:T,onChange:i=>Y(i.target.value),className:`mt-1 w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                    text-sm text-white
                    focus:outline-none focus:ring-1 focus:ring-stone-900 focus:border-stone-900
                    transition-colors duration-200`,disabled:u.length===0,children:[e.jsx("option",{value:"",children:"Select a node"}),u.map(i=>e.jsxs("option",{value:i.id,children:[i.name," (",i.fqdn,")"]},i.id))]}),u.length===0&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No unassigned nodes available"})]}),e.jsx(f,{onClick:xe,disabled:!T||W||u.length===0,variant:"secondary",children:W?"Assigning...":"Assign Node"})]})]})})})})]}):e.jsx("div",{className:"bg-stone-950 border border-stone-900 rounded-md shadow-xs",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-sm font-medium text-white",children:"Servers in Region"})}),t>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["There are ",t," servers running across"," ",n.nodes.length," nodes in this region."]}),e.jsx("div",{className:"py-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Visit the Servers page to see more details about individual servers."})})]}):e.jsx("div",{className:"py-6 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No servers in this region"})})]})})]})},ge=()=>{const t=he();return e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-transparent",children:[e.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-500 tracking-wider cursor-pointer",onClick:()=>$("name"),children:e.jsx("div",{className:"flex items-center",children:"Name"})}),e.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-500 tracking-wider cursor-pointer",onClick:()=>$("identifier"),children:e.jsx("div",{className:"flex items-center",children:"Identifier"})}),e.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-500 tracking-wider cursor-pointer",onClick:()=>$("country"),children:e.jsx("div",{className:"flex items-center",children:"Country"})}),e.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-500 tracking-wider cursor-pointer",onClick:()=>$("nodes"),children:e.jsx("div",{className:"flex items-center",children:"Nodes"})}),e.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-500 tracking-wider cursor-pointer",onClick:()=>$("servers"),children:e.jsx("div",{className:"flex items-center",children:"Servers"})}),e.jsx("th",{className:"p-3 text-right text-xs font-medium text-gray-500 tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-stone-900 bg-stone-950",children:[t.map(s=>{var a,l,i,S;const r=((a=q.find(d=>d.value===s.countryId))==null?void 0:a.label)||s.countryId||"-";return e.jsxs("tr",{className:"hover:bg-stone-900 cursor-pointer",onClick:()=>{C(s),j("view")},children:[e.jsx("td",{className:"p-3 text-xs text-white",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(we,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"font-medium",children:s.name})]})}),e.jsx("td",{className:"p-3 text-xs text-white",children:s.identifier}),e.jsx("td",{className:"p-3 text-xs text-white",children:r}),e.jsxs("td",{className:"p-3 text-xs text-white",children:[s.nodes.length," ",s.nodes.length===1?"node":"nodes",e.jsxs("span",{className:"text-gray-400 ml-1",children:["(",((l=s.stats)==null?void 0:l.onlineNodeCount)||0," online)"]})]}),e.jsxs("td",{className:"p-3 text-xs text-white",children:[((i=s.stats)==null?void 0:i.serverCount)||0," ",(((S=s.stats)==null?void 0:S.serverCount)||0)===1?"server":"servers",s.serverLimit&&e.jsxs("span",{className:"text-gray-400 ml-1",children:["/ ",s.serverLimit]})]}),e.jsx("td",{className:"p-3 text-right whitespace-nowrap",children:e.jsx("div",{className:"flex items-center justify-end",onClick:d=>d.stopPropagation(),children:e.jsx("button",{onClick:d=>{d.stopPropagation(),D({region:s,position:{x:d.clientX,y:d.clientY}})},className:"p-1 text-[#9CA3AF] cursor-pointer hover:text-white",children:e.jsx(be,{className:"w-4 h-4"})})})})]},s.id)}),c.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-center text-white text-xs",children:"No regions found"})})]})]})})};return g&&c.length===0?e.jsx("div",{className:"min-h-screen",children:e.jsx("div",{className:"p-6 flex items-center justify-center h-64",children:e.jsx(je,{})})}):e.jsxs("div",{className:"card min-h-screen bg-stone-950",children:[e.jsx(J,{children:N&&e.jsx(ke,{region:N.region,position:N.position,onClose:()=>D(null),onEdit:()=>{p({name:N.region.name,identifier:N.region.identifier,countryId:N.region.countryId||void 0,fallbackRegionId:N.region.fallbackRegionId||void 0,serverLimit:N.region.serverLimit||void 0}),C(N.region),w(!0),D(null)},onDelete:()=>{_(N.region.id),D(null)}})}),e.jsxs("div",{className:"h-min-screen",children:[H.length>0&&e.jsx("div",{className:"mb-4 space-y-2",children:H.map(t=>e.jsx(re,{type:t.type,message:t.message,onDismiss:()=>le(t.id)},t.id))}),e.jsxs("div",{className:"transition-all duration-200 ease-in-out",children:[y==="list"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-white",children:"Regions"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Group your nodes into regions for better organization and load balancing."})]}),e.jsx("div",{className:"flex space-x-3",children:e.jsx(f,{onClick:()=>x(!0),variant:"secondary",icon:e.jsx(te,{className:"w-3.5 h-3.5 mr-1.5"}),children:"Create Region"})})]}),e.jsx("div",{className:"bg-stone-950 border border-stone-900 rounded-md shadow-xs",children:ge()})]}),e.jsx(J,{children:I&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80",onClick:()=>x(!1),children:e.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.15},className:"bg-stone-950 border border-stone-900 rounded-lg max-w-lg w-full p-6 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"flex items-center space-x-4 mb-4",children:e.jsx("h1",{className:"text-lg font-semibold text-white flex-1",children:"Create Region"})}),ee("create")]})})}),e.jsx(J,{children:k&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80",onClick:()=>{w(!1),p({name:"",identifier:""}),j("view")},children:e.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.15},className:"bg-stone-950 border border-stone-900 rounded-lg max-w-lg w-full p-6 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"flex items-center space-x-4 mb-4",children:e.jsx("h1",{className:"text-lg font-semibold text-white flex-1",children:"Edit Region"})}),ee("edit")]})})}),y==="view"&&ue()]})]})]})};export{Ie as default};
