import{r as i,j as e,i as V,k as Ne,B as b,c as be,u as ye,L as we,b as R,d as Ae}from"./main-D6weWVn6.js";import{D as Ce,a as ke,b as Ie,c as Se,d as Be,F as Me}from"./dialog-E-Y7NT0w.js";import{C as Ee}from"./circle-alert-C2iG5II5.js";import{P as oe,A as ne,T as Pe}from"./trash-BRkT18N2.js";import{C as De}from"./chevron-right-DT_2dYLm.js";const Re=i.forwardRef(({className:l,type:o,...a},m)=>e.jsx("input",{type:o,className:V("w-full px-3 py-2 rounded-md bg-[#0E0E0F] border border-[#1E1E20] text-sm text-[#FFFFFF] focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325] transition-colors duration-200",l),ref:m,...a}));Re.displayName="Input";const re=l=>typeof l=="boolean"?`${l}`:l===0?"0":l,ae=Ne,Ue=(l,o)=>a=>{var m;if((o==null?void 0:o.variants)==null)return ae(l,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:F,defaultVariants:v}=o,k=Object.keys(F).map(f=>{const j=a==null?void 0:a[f],y=v==null?void 0:v[f];if(j===null)return null;const p=re(j)||re(y);return F[f][p]}),B=a&&Object.entries(a).reduce((f,j)=>{let[y,p]=j;return p===void 0||(f[y]=p),f},{}),M=o==null||(m=o.compoundVariants)===null||m===void 0?void 0:m.reduce((f,j)=>{let{class:y,className:p,...U}=j;return Object.entries(U).every(O=>{let[E,g]=O;return Array.isArray(g)?g.includes({...v,...B}[E]):{...v,...B}[E]===g})?[...f,y,p]:f},[]);return ae(l,k,M,a==null?void 0:a.class,a==null?void 0:a.className)},Oe=Ue("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-1px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-[#0E0E0F] border-[#1E1E20] text-[#FFFFFF]",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive bg-red-500/20"}},defaultVariants:{variant:"default"}}),le=i.forwardRef(({className:l,variant:o,...a},m)=>e.jsx("div",{ref:m,role:"alert",className:V(Oe({variant:o}),l),...a}));le.displayName="Alert";const Te=i.forwardRef(({className:l,...o},a)=>e.jsx("h5",{ref:a,className:V("mb-1 font-medium leading-none tracking-tight",l),...o}));Te.displayName="AlertTitle";const de=i.forwardRef(({className:l,...o},a)=>e.jsx("div",{ref:a,className:V("text-sm [&_p]:leading-relaxed",l),...o}));de.displayName="AlertDescription";const qe=({isOpen:l,onClose:o,title:a,children:m,footer:F})=>e.jsx(Ce,{open:l,onOpenChange:o,children:e.jsxs(ke,{className:"bg-[#0E0E0F] border border-[#1E1E20] text-white",children:[e.jsx(Ie,{children:e.jsx(Se,{children:a})}),m,F&&e.jsx(Be,{children:F})]})}),ie=({isOpen:l,onClose:o,title:a,children:m,onSubmit:F,isSubmitting:v=!1,error:k=null,submitText:B="Save",cancelText:M="Cancel"})=>e.jsx(qe,{isOpen:l,onClose:o,title:a,footer:e.jsxs(e.Fragment,{children:[e.jsx(b,{onClick:o,disabled:v,children:M}),e.jsx(b,{variant:"secondary",onClick:F,disabled:v,icon:e.jsx(oe,{className:"w-4 h-4"}),children:v?"Creating...":B})]}),children:e.jsxs("form",{id:"modal-form",onSubmit:F,className:"space-y-4",children:[k&&e.jsxs(le,{variant:"destructive",children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx(de,{children:k})]}),m]})}),He=()=>{const[l,o]=i.useState(!1),[a,m]=i.useState([]),[F,v]=i.useState([]),[k,B]=i.useState([]),[M,f]=i.useState([]),[j,y]=i.useState([]),[p,U]=i.useState(!0),[O,E]=i.useState(null),[g,I]=i.useState("list"),[n,P]=i.useState(null),{user:$}=be(),W=ye();i.useEffect(()=>{(!$||!$.permissions.includes("admin"))&&W("/unauthorized",{replace:!0})},[$,W]);const[w,z]=i.useState("nodes"),[ce,G]=i.useState(!1),[h,_]=i.useState({name:"",nodeId:"",unitId:"",userId:"",allocationId:"",memoryMiB:1024,diskMiB:10240,cpuPercent:100}),[d,S]=i.useState({name:"",unitId:"",memoryMiB:0,diskMiB:0,cpuPercent:0}),[D,A]=i.useState(null),[ue,K]=i.useState(!1),[Y]=i.useState(""),[H]=i.useState(""),[xe,me]=i.useState([]),[Q,he]=i.useState([]),[X,J]=i.useState(!1);i.useEffect(()=>{T()},[]),i.useEffect(()=>{g==="create"&&Fe()},[g]),i.useEffect(()=>{const t=M.filter(r=>r.username.toLowerCase().includes(Y.toLowerCase()));me(t)},[Y,M]),i.useEffect(()=>{const t=k.filter(r=>r.name.toLowerCase().includes(H.toLowerCase())||r.shortName.toLowerCase().includes(H.toLowerCase()));he(t)},[H,k]);const Fe=async()=>{G(!0);try{const t=localStorage.getItem("token"),r=await fetch("/api/regions",{headers:{Authorization:`Bearer ${t}`}});if(!r.ok)throw new Error("Failed to fetch regions");const c=await r.json();y(c)}catch(t){console.error("Failed to fetch regions:",t),z("nodes")}finally{G(!1)}},T=async()=>{try{U(!0);const r={Authorization:`Bearer ${localStorage.getItem("token")}`},[c,u,s,x,C]=await Promise.all([fetch("/api/servers?include[node]=true&include[unit]=true&include[user]=true",{headers:r}),fetch("/api/nodes",{headers:r}),fetch("/api/units",{headers:r}),fetch("/api/users",{headers:r}),fetch("/api/regions",{headers:r})]);if(!c.ok)throw new Error("Failed to fetch servers");if(!u.ok)throw new Error("Failed to fetch nodes");if(!s.ok)throw new Error("Failed to fetch units");if(!x.ok)throw new Error("Failed to fetch users");const[q,L,pe,ge]=await Promise.all([c.json(),u.json(),s.json(),x.json()]);let te=[];C.ok&&(te=await C.json(),y(te)),m(q),v(L),B(pe),f(ge),E(null)}catch(t){E(t instanceof Error?t.message:"An error occurred")}finally{U(!1)}},Z=async t=>{t.preventDefault(),A(null);try{const r={...h};!!r.regionId&&(delete r.nodeId,delete r.allocationId);const u=localStorage.getItem("token"),s=await fetch("/api/servers",{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok){const x=await s.json();throw new Error(x.error||"Failed to create server")}await T(),I("list"),_({name:"",nodeId:"",unitId:"",userId:"",allocationId:"",memoryMiB:1024,diskMiB:10240,cpuPercent:100,regionId:""})}catch(r){A(r instanceof Error?r.message:"Failed to create server")}},ee=async t=>{if(t.preventDefault(),!!n){A(null),J(!0);try{const r={};if(d.name!==n.name&&(r.name=d.name),d.unitId!==n.unitId&&(r.unitId=d.unitId),d.memoryMiB!==n.memoryMiB&&(r.memoryMiB=d.memoryMiB),d.diskMiB!==n.diskMiB&&(r.diskMiB=d.diskMiB),d.cpuPercent!==n.cpuPercent&&(r.cpuPercent=d.cpuPercent),Object.keys(r).length===0){I("view"),J(!1);return}const c=localStorage.getItem("token"),u=await fetch(`/api/servers/${n.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!u.ok){const x=await u.json();throw new Error(x.error||"Failed to update server")}await T();const s=a.find(x=>x.id===n.id);s&&P(s),I("view")}catch(r){A(r instanceof Error?r.message:"Failed to update server")}finally{J(!1)}}},fe=async t=>{try{const r=localStorage.getItem("token"),c=await fetch(`/api/servers/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}});if(!c.ok){const u=await c.json();throw new Error(u.error||"Failed to delete server")}await T(),(n==null?void 0:n.id)===t&&(I("list"),P(null))}catch(r){E(r instanceof Error?r.message:"Failed to delete server")}},N=t=>{_(r=>({...r,...t}))},se=()=>{var t,r,c,u;return e.jsxs("form",{onSubmit:Z,className:"space-y-4 max-w-lg",children:[D&&e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-red-600",children:D})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Name"}),e.jsx("input",{type:"text",value:h.name,onChange:s=>N({name:s.target.value}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-[#FFFFFF]
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,placeholder:"my-server",required:!0})]}),e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex pr-3 space-x-2",children:[e.jsx(b,{type:"button",onClick:()=>z("nodes"),variant:w==="nodes"?"primary":"secondary",className:w==="nodes"?"font-bold":"font-normal",children:"Specific Node"}),e.jsx(b,{type:"button",onClick:()=>z("regions"),variant:w==="regions"?"primary":"secondary",className:w==="regions"?"font-bold":"font-normal",children:"Region (Load Balanced)"})]})}),w==="nodes"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Node"}),e.jsxs("select",{value:h.nodeId||"",onChange:s=>N({nodeId:s.target.value,regionId:"",allocationId:""}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-[#FFFFFF]
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,required:w==="nodes",children:[e.jsx("option",{value:"",children:"Select a node"}),F.map(s=>e.jsxs("option",{value:s.id,disabled:!s.isOnline,children:[s.name," (",s.fqdn,") ",!s.isOnline&&"- Offline"]},s.id))]})]}),h.nodeId&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Port Allocation"}),e.jsxs("select",{value:h.allocationId||"",onChange:s=>N({allocationId:s.target.value}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-[#FFFFFF]
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,required:w==="nodes",children:[e.jsx("option",{value:"",children:"Select a port allocation"}),(r=(t=F.find(s=>s.id===h.nodeId))==null?void 0:t.allocations)==null?void 0:r.filter(s=>!s.assigned).map(s=>e.jsxs("option",{value:s.id,children:[s.bindAddress,":",s.port,s.alias&&` (${s.alias})`]},s.id))]}),((u=(c=F.find(s=>s.id===h.nodeId))==null?void 0:c.allocations)==null?void 0:u.filter(s=>!s.assigned).length)===0&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No available allocations on this node. Please select a different node or create allocations."})]})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Region"}),ce?e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-stone-900 rounded-full border-t-transparent"}),e.jsx("span",{className:"text-xs text-[#FFFFFF]",children:"Loading regions..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:h.regionId||"",onChange:s=>N({regionId:s.target.value,nodeId:"",allocationId:""}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-[#FFFFFF]
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,required:w==="regions",children:[e.jsx("option",{value:"",children:"Select a region"}),j.map(s=>{var x,C,q,L;return e.jsxs("option",{value:s.id,disabled:((x=s.stats)==null?void 0:x.onlineNodeCount)===0||((C=s.stats)==null?void 0:C.atCapacity),children:[s.name,((q=s.stats)==null?void 0:q.onlineNodeCount)===0?" (No online nodes)":"",(L=s.stats)!=null&&L.atCapacity?" (At capacity)":""]},s.id)})]}),j.length===0&&e.jsx("p",{className:"text-xs text-white mt-1",children:"No regions configured. Please create a region first or select a specific node."}),e.jsxs("p",{className:"text-xs text-gray-300 mt-1",children:[Ae," will automatically select the best node in this region"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Unit"}),e.jsxs("select",{value:h.unitId,onChange:s=>N({unitId:s.target.value}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,required:!0,children:[e.jsx("option",{value:"",children:"Select a unit"}),Q.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.shortName,")"]},s.id))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"User"}),e.jsxs("select",{value:h.userId,onChange:s=>N({userId:s.target.value}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,required:!0,children:[e.jsx("option",{value:"",children:"Select a user"}),xe.map(s=>e.jsx("option",{value:s.id,children:s.username},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Memory (MiB)"}),e.jsx("input",{type:"number",value:h.memoryMiB,onChange:s=>N({memoryMiB:parseInt(s.target.value)}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,min:128,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Disk (MiB)"}),e.jsx("input",{type:"number",value:h.diskMiB,onChange:s=>N({diskMiB:parseInt(s.target.value)}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,min:1024,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"CPU (%)"}),e.jsx("input",{type:"number",value:h.cpuPercent,onChange:s=>N({cpuPercent:parseInt(s.target.value)}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,min:25,max:400,required:!0})]})]})]})},ve=()=>n?e.jsxs("form",{onSubmit:ee,className:"space-y-4 max-w-lg",children:[D&&e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-red-600",children:D})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-white",children:"Name"}),e.jsx("input",{type:"text",value:d.name,onChange:t=>S({...d,name:t.target.value}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,placeholder:"my-server",required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-white",children:"Unit"}),e.jsx("select",{value:d.unitId,onChange:t=>S({...d,unitId:t.target.value}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,required:!0,children:Q.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.shortName,")"]},t.id))}),d.unitId!==n.unitId&&e.jsx("p",{className:"mt-2 text-yellow-600 text-xs",children:"Warning: Changing the unit will reinstall the server with the new image. Your server data will be preserved, but the environment will change."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Memory (MiB)"}),e.jsx("input",{type:"number",value:d.memoryMiB,onChange:t=>S({...d,memoryMiB:parseInt(t.target.value)}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,min:128,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-[#FFFFFF]",children:"Disk (MiB)"}),e.jsx("input",{type:"number",value:d.diskMiB,onChange:t=>S({...d,diskMiB:parseInt(t.target.value)}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,min:1024,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-white",children:"CPU (%)"}),e.jsx("input",{type:"number",value:d.cpuPercent,onChange:t=>S({...d,cpuPercent:parseInt(t.target.value)}),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                                  text-sm text-white
                                  focus:outline-none focus:ring-1 focus:ring-[#232325] focus:border-[#232325]
                                  transition-colors duration-200`,min:25,max:400,required:!0})]})]})]}):null,je=()=>{var r,c,u,s,x,C;if(!n)return null;const t=(r=n.node)==null?void 0:r.region;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(b,{onClick:()=>{I("list"),P(null)},variant:"secondary",children:e.jsx(ne,{className:"w-3.5 h-3.5 mr-1.5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-[#FFFFFF]",children:n.name}),e.jsx("p",{className:"text-xs text-[#FFFFFF]",children:n.internalId})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(b,{onClick:()=>{S({name:n.name,unitId:n.unitId,memoryMiB:n.memoryMiB,diskMiB:n.diskMiB,cpuPercent:n.cpuPercent}),A(null),o(!0)},variant:"secondary",children:[e.jsx(Me,{className:"w-3.5 h-3.5 mr-1.5"}),"Edit"]}),e.jsxs(b,{variant:"danger",onClick:()=>fe(n.id),children:[e.jsx(Pe,{className:"w-3.5 h-3.5 mr-1.5"}),"Delete"]})]})]}),e.jsx("div",{className:"bg-stone-950 border border-stone-900 rounded-lg overflow-hidden",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Server ID"}),e.jsx("div",{className:"text-sm font-mono mt-1 text-[#FFFFFF]",children:n.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Name"}),e.jsx("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:n.name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Internal ID"}),e.jsx("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:n.internalId})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Current State"}),e.jsxs("div",{className:"text-sm mt-1",children:[n.state==="running"&&e.jsx(R,{variant:"success",children:n.state}),n.state==="stopped"&&e.jsx(R,{variant:"info",children:n.state}),["creating","installing","updating","deleting"].includes(n.state)&&e.jsx(R,{variant:"warning",children:n.state}),["starting","stopping"].includes(n.state)&&e.jsx(R,{variant:"warning",children:n.state}),["install_failed","update_failed","errored"].includes(n.state)&&e.jsx(R,{variant:"danger",children:n.state}),["installed"].includes(n.state)&&e.jsx(R,{variant:"info",children:n.state})]})]}),e.jsxs("div",{className:"pt-4 border-t border-stone-900",children:[e.jsx("div",{className:"text-xs font-medium text-white mb-3",children:"Resources"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Memory"}),e.jsxs("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:[n.memoryMiB," MiB"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Disk"}),e.jsxs("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:[n.diskMiB," MiB"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"CPU"}),e.jsxs("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:[n.cpuPercent,"%"]})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-stone-900",children:[e.jsx("div",{className:"text-xs font-medium text-[#FFFFFF] mb-3",children:"Relationships"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Node"}),e.jsxs("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:[(c=n.node)==null?void 0:c.name," (",(u=n.node)==null?void 0:u.fqdn,")"]})]}),t&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Region"}),e.jsxs("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:[t.name," (",t.identifier,")"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Unit"}),e.jsxs("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:[(s=n.unit)==null?void 0:s.name," (",(x=n.unit)==null?void 0:x.shortName,")"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"User"}),e.jsx("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:(C=n.user)==null?void 0:C.username})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-[#232325]",children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Created At"}),e.jsx("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:new Date(n.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#A1A1AA]",children:"Updated At"}),e.jsx("div",{className:"text-sm mt-1 text-[#FFFFFF]",children:new Date(n.updatedAt).toLocaleString()})]})]})})})]})};return p?e.jsx(we,{}):O?e.jsx("div",{className:"min-h-screen bg-stone-950",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-red-600 text-xs",children:["Error: ",O]})})}):e.jsx("div",{className:"card min-h-screen bg-stone-950",children:e.jsx("div",{children:e.jsxs("div",{className:"transition-all duration-200 ease-in-out",children:[g==="list"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-[#FFFFFF]",children:"Servers"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Manage all servers running on your nodes."})]}),e.jsxs(b,{onClick:()=>K(!0),variant:"secondary",children:[e.jsx(oe,{className:"w-3.5 h-3.5 mr-1.5"}),"Create Server"]})]}),e.jsxs("div",{className:"space-y-1.5",children:[a.map(t=>{var r,c,u,s;return e.jsx("div",{className:"block bg-stone-950 rounded-md border border-stone-900 overflow-hidden cursor-pointer w-full",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"px-3 py-3 flex-grow flex items-center justify-between transition-colors duration-150",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${((c=(r=t.status)==null?void 0:r.status)==null?void 0:c.state)==="running"?"bg-[#10B981]":"bg-[#9CA3AF]"}`})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("button",{className:"text-xs font-medium text-[#FFFFFF] truncate",onClick:()=>{P(t),S({name:t.name,unitId:t.unitId,memoryMiB:t.memoryMiB,diskMiB:t.diskMiB,cpuPercent:t.cpuPercent}),A(null),o(!0)},children:t.name},t.id),e.jsx("div",{className:"text-[11px] text-[#9CA3AF] flex items-center",children:e.jsx("span",{children:(s=(u=t.status)==null?void 0:u.status)==null?void 0:s.id})})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"text-[11px] text-[#9CA3AF]",children:[e.jsxs("span",{className:"font-medium text-[#FFFFFF]",children:[t.cpuPercent,"%"]})," ","CPU limit"]}),e.jsxs("div",{className:"text-[11px] text-[#9CA3AF]",children:[e.jsxs("span",{className:"font-medium text-[#FFFFFF]",children:[(t.memoryMiB/1024).toFixed(2)," GiB"]})," ","Memory limit"]})]}),e.jsx("button",{onClick:()=>{P(t),I("view")},children:e.jsx(De,{className:"h-3.5 w-3.5 text-[#9CA3AF]"})})]})]})})})}),a.length===0&&e.jsx("div",{className:"text-center py-6 bg-stone-950 rounded-md border border-stone-900",children:e.jsx("p",{className:"text-xs text-gray-500",children:"No servers found"})})]}),e.jsx(ie,{isOpen:ue,onClose:()=>{K(!1),A(null),_({name:"",nodeId:"",unitId:"",userId:"",allocationId:"",memoryMiB:1024,diskMiB:10240,cpuPercent:100,regionId:""})},title:"Create Server",onSubmit:Z,isSubmitting:p,error:D,submitText:"Create Server",cancelText:"Cancel",children:se()})]}),g==="create"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(b,{onClick:()=>{I("list"),P(null)},variant:"secondary",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-lg font-semibold text-[#FFFFFF]",children:"Create Server"})})]}),se()]}),e.jsx(ie,{isOpen:l,onClose:()=>{o(!1),A(null)},title:n?`Edit Server: ${n.name}`:"Edit Server",onSubmit:ee,isSubmitting:X,error:D,submitText:X?"Updating...":"Update Server",cancelText:"Cancel",children:ve()}),g==="view"&&je()]})})})};export{He as default};
