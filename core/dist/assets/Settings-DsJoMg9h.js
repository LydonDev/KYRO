import{p as A,u as R,r,j as e,L as B,m as T,B as m,t as z}from"./main-D6weWVn6.js";import{F as w,a as y}from"./ExclamationCircleIcon-DxZzJXJ6.js";import{F as S}from"./TrashIcon-CRYsBrOY.js";const O=()=>{const{id:x}=A(),l=R(),[s,h]=r.useState(null),[E,f]=r.useState(!0),[c,i]=r.useState(null),[o,F]=r.useState(""),[p,j]=r.useState(!1),[v,g]=r.useState(!1),[k,u]=r.useState(!1),[d,C]=r.useState(null),b=r.useRef(null);r.useEffect(()=>((async()=>{try{f(!0),i(null);const a=localStorage.getItem("token"),n=await fetch(`/api/servers/${x}?include[node]=true&include[status]=true`,{method:"GET",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error("Failed to fetch server details");const N=await n.json();h(N),F(N.name)}catch(a){i(a instanceof Error?a.message:"An error occurred")}finally{f(!1)}})(),()=>{b.current&&b.current.close()}),[x]);const D=async()=>{if(!(!s||!o.trim()||o.trim()===s.name)){j(!0),C(null),i(null);try{const t=localStorage.getItem("token");if(!(await fetch(`/api/servers/${s.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({name:o.trim()})})).ok)throw new Error("Failed to update server name");h(n=>n?{...n,name:o.trim()}:null)}catch(t){i(t instanceof Error?t.message:"Failed to rename server"),j(!1)}}},$=async()=>{if(s){g(!0),i(null);try{const t=localStorage.getItem("token"),a=await fetch(`/api/servers/${s.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!a.ok){const n=await a.json();throw new Error(n.error||n.details||"Failed to delete server")}l("/servers")}catch(t){i(t instanceof Error?t.message:"Failed to delete server"),g(!1),u(!1)}}};if(E)return e.jsx(B,{});if(c)throw new Error(c);return s||l("/unauthorized"),e.jsx("div",{className:"card bg-stone-950 p-6 min-h-screen",children:e.jsxs("div",{className:"flex flex-col h-full max-w-[1500px] mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center text-sm text-[#9CA3AF] mb-4",children:[e.jsx("button",{onClick:()=>l("/servers"),className:"hover:text-[#FFFFFF] transition-colors duration-100",children:"Servers"}),e.jsx(w,{className:"w-4 h-4 mx-1"}),e.jsx("button",{onClick:()=>l(`/servers/${x}`),className:"hover:text-[#FFFFFF] transition-colors duration-100",children:s==null?void 0:s.name}),e.jsx(w,{className:"w-4 h-4 mx-1"}),e.jsx("span",{className:"text-[#FFFFFF] font-medium",children:"Settings"})]}),e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-xl font-semibold text-[#FFFFFF] mr-4",children:"Settings"}),c&&e.jsxs(T.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center px-3 py-1.5 text-xs text-[#EF4444] bg-[#0E0E0F] border border-[#1E1E20] rounded-md",children:[e.jsx(y,{className:"w-3.5 h-3.5 mr-1.5"}),c]})]})})]}),e.jsx("div",{className:"bg-stone-950 border border-stone-900 rounded-lg",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-[#FFFFFF] mb-4",children:"Server Name"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col space-y-3 md:flex-row md:space-y-0 md:space-x-4 md:items-center",children:[e.jsx("input",{type:"text",value:o,onChange:t=>F(t.target.value),className:`w-full px-3 py-2 rounded-md bg-stone-950 border border-stone-900
                    text-sm text-[#FFFFFF]
                    focus:outline-none focus:ring-1 focus:ring-stone-900 focus:border-stone-900
                    transition-colors duration-200`,placeholder:"Enter server name"}),e.jsx(m,{variant:"primary",onClick:D,disabled:p||o.trim()===(s==null?void 0:s.name)||!o.trim(),isLoading:p,icon:e.jsx(z,{className:"w-4 h-4"}),children:"Save"})]}),d&&e.jsxs("div",{className:`flex items-center p-3 text-sm rounded-md ${d.type==="success"?"bg-stone-950 border border-stone-900 text-[#10B981]":"bg-stone-950 border border-stone-900 text-[#EF4444]"}`,children:[d.type==="success"?e.jsx("div",{className:"w-4 h-4 mr-2",children:"âœ“"}):e.jsx(y,{className:"w-4 h-4 mr-2"}),d.message]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-[#FFFFFF] mb-4",children:"Danger Zone"}),e.jsx("div",{className:"bg-stone-950 p-4 rounded-md border border-stone-900",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"mb-4 md:mb-0",children:[e.jsx("h3",{className:"text-sm font-medium text-[#FFFFFF]",children:"Delete Server"}),e.jsx("p",{className:"text-sm text-[#9CA3AF] mt-1",children:"Once you delete a server, there is no going back. Please be certain."})]}),k?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{onClick:()=>u(!1),variant:"secondary",children:"Cancel"}),e.jsx(m,{onClick:$,disabled:v,variant:"danger",children:v?e.jsxs("span",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4"}),"Confirm Delete"]})})]}):e.jsx(m,{onClick:()=>u(!0),variant:"danger",size:"sm",icon:e.jsx(S,{className:"w-4 h-4"}),children:"Delete Server"})]})})]})]})})]})})};export{O as default};
